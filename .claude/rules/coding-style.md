---
description: 程式碼風格規範
globs: "*.js,*.jsx"
---

# 程式碼風格

## 不可變性（Critical）
- 永遠建立新物件，不要直接修改既有物件
- 使用展開運算子（spread）、map、filter 進行更新
- 避免 push、splice 等會改變原陣列的方法

## 檔案組織
- 多個小檔案優於少量大檔案
- 每檔 200-400 行，上限 800 行
- 按功能（feature）組織，不按檔案類型

## 錯誤處理
- 所有層級都要適當處理錯誤
- 對使用者顯示友善訊息
- 對開發者記錄詳細日誌

## 輸入驗證
- 在系統邊界驗證所有輸入
- 使用 schema 驗證，快速失敗

## 品質檢查清單
- [ ] 程式碼可讀性高
- [ ] 函式不超過 50 行
- [ ] 檔案聚焦於單一功能
- [ ] 巢狀不超過 4 層
- [ ] 有適當的錯誤處理
- [ ] 設定值使用常數或環境變數
- [ ] 遵循不可變模式
